<div class="row">
	<div class="col-sm-6">
		<div class="well">
			<h3 class="margin-top-0">
				<i class="fa fa-stack-overflow"></i>
				{{vm.documentTemplate.name}}
				<small>{{vm.documentTemplate.description}}</small>

				<ui-select ng-model="vm.documentTemplate.version"
									 class="pull-right"
									 on-select="vm.changeDocumentVersion($item, $model)"
									 style="width: 80px">
					<ui-select-match>v. {{$select.selected.version}}</ui-select-match>
					<ui-select-choices repeat="version.version as version in vm.documentTemplate.versions">
						v. {{version.version}}
					</ui-select-choices>
				</ui-select>
			</h3>

			<hr/>

			<form id="fieldTemplate" neo-validate novalidate>
				<!-- RECURSIVE_FIELD_TREE -->
				<!-- WARNING! Magic happens here! -->
				<script type="text/ng-template" id="docsFieldLevel">
					<docs-field field="field" container="container"></docs-field>

					<div ng-if="field.composite.length" class="clearfix">
						<div>
							<strong>{{field.label}}</strong>

							<div class="pull-right display-block">
								<a href-void class="drag-handle">
									<i class="fa fa-fw fa-arrows text-muted" hover-class="text-primary"></i>
								</a>
								<a href-void ng-click="vm.deleteField(field)">
									<i class="fa fa-fw fa-trash-o text-muted" hover-class="text-danger"></i>
								</a>
							</div>
							<hr class="margin-top-5"/>
						</div>

						<div gridster="vm.nestedGridsterOptions" class="no-padding">
							<div ng-init="container = field"
									 ng-repeat="field in field.composite track by $index"
									 ng-include="'docsFieldLevel'"
									 gridster-item="field"></div>
						</div>
					</div>

				</script>

				<ul gridster class="no-padding list-unstyled margin-bottom-10">

					<li ng-init="container = vm.documentTemplate"
							ng-repeat="field in vm.documentTemplate.composite track by $index"
							ng-if="vm.documentTemplate.composite"
							gridster-item="field"
							style="padding: 0 10px"
							ng-include="'docsFieldLevel'">
					</li>

				</ul>

				<!-- end:RECURSIVE_FIELD_TREE -->
			</form>

			<div class="row">
				<div class="col-sm-12">
					<div class="text-center">
						<docs-add-field container="vm.documentTemplate"></docs-add-field>
						<docs-add-composite-field container="vm.documentTemplate"></docs-add-composite-field>
					</div>
				</div>
			</div>
		</div>
	</div>


	<div class="col-sm-3">
		<div class="well">
			<h3 class="margin-top-0">
				<i class="fa fa-empire"></i>
				Template properties
			</h3>

			<hr/>

			<fieldset>
				<div class="row">
					<div class="col-sm-12">
						<div class="form-group">
							<label>Name:</label>
							<input type="text"
										 class="form-control input-sm"
										 ng-model="vm.documentTemplate.name"/>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-sm-12">
						<div class="form-group">
							<label>Description:</label>
					<textarea class="form-control"
										rows="3"
										ng-model="vm.documentTemplate.description"
										style="resize: none;">
					</textarea>
						</div>
					</div>
				</div>
			</fieldset>

			<div class="form-actions">
				<div class="row">
					<div class="col-md-12">
						<button class="btn btn-primary" type="button" ng-click="vm.save()">
							<i class="fa fa-save"></i> Save
						</button>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
